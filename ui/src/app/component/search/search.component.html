<ng-container *ngIf="auth.canSearch(); else unauthorised">
  <div class="progress rounded-0 position-absolute h-1 w-100" *ngIf="searching">
    <div class="progress-bar progress-bar-striped progress-bar-animated bg-info w-100"></div>
  </div>
  <div class="jumbotron animate-padding" [ngClass]="{'jumbotron-compact': users.length > 0}">
    <div class="container">
      <h1>Search</h1>
      <form (ngSubmit)="search()" #form="ngForm">
        <div class="form-group">
          <label for="query">
              Use this screen to search for an existing user<ng-container *ngIf="auth.canAddUser()" >, or
              <a routerLink="/user">click here to add a new user</a> </ng-container>.
          </label>
          <div class="input-group">
            <input #queryInput="ngModel" id="query" name="query" type="search" class="form-control" [(ngModel)]="query"
                   placeholder="Search using name, username, team, staff code..."
                   autocomplete="off">
            <div class="input-group-append">
              <button class="btn btn-primary" type="submit">
                <span class="oi oi-magnifying-glass"></span>
              </button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="container" *ngIf="!searching && noResults && query != ''">
    <div class="card card-body bg-light">No results&hellip;</div>
  </div>
  <div class="container" *ngIf="users.length > 0">
    <div class="card border-top-0">
    <table class="table table-hover mb-0">
      <thead class="thead-light">
        <tr>
          <th>Name</th>
          <th>Username</th>
          <th>Staff Code</th>
          <th>Team(s)</th>
          <th class="text-right">Sources</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of users" routerLink="/user/{{user.username}}" style="cursor: pointer">
          <td class="font-weight-bold">{{user.forenames}} {{user.surname}}</td>
          <td>
            <span title="Username">{{user.username}}</span>
            <span title="DOM1 Alias" *ngIf="user.aliasUsername != null">, {{user.aliasUsername}}</span>
          </td>
          <td>{{user.staffCode}}</td>
          <td>
            <span *ngFor="let team of user.teams; let isLast = last">
              {{team.description}}{{isLast? '': ','}}
            </span>
          </td>
          <td class="text-right">
            <span class="badge badge-pill ml-1 badge-{{user.inNationalDelius? 'success': 'danger'}}"
                  title="National Delius">ND</span>
            <span class="badge badge-pill ml-1 badge-{{user.inPrimaryAD? 'success': 'danger'}}"
                  title="TTP Active Directory">DOM1</span>
            <span class="badge badge-pill ml-1 badge-{{user.inSecondaryAD? 'success': 'danger'}}"
                  title="Steria Active Directory">OMNI</span>
          </td>
          <td class="text-right">
            <span class="oi oi-chevron-right"></span>
          </td>
        </tr>
      </tbody>
    </table>
    </div>
    <hr/>
    <div class="btn-toolbar justify-content-center">
      <div class="btn-group">
        <button class="btn btn-outline-secondary" [disabled]="page <= 1" (click)="prevPage()">
          <span class="oi oi-arrow-left"></span>
          Previous
        </button>
        <button class="btn btn-outline-secondary" [disabled]="!hasMoreResults" (click)="nextPage()">
          Next
          <span class="oi oi-arrow-right"></span>
        </button>
      </div>
    </div>
    <br/>
  </div>
</ng-container>
<ng-template #unauthorised>You are not authorised to search for users.</ng-template>
